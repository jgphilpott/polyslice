<html>
  <head>
    <title>Web Serial API Demo</title>
  </head>
  <body>
    <button id="connect">Connect</button>
    <script>

        var device
        let button = document.getElementById("connect")

        document.addEventListener("DOMContentLoaded", event => {
            button.addEventListener("click", async () => {
                try {

                    device = await navigator.serial.requestPort()

                    await device.open({baudRate: 115200})

                    console.log("Opened: ", device)
                    console.log("Info: ", device.getInfo())

                    const encoder = new TextEncoder()
                    const writer = device.writable.getWriter()

                    await writer.write(encoder.encode("G28\n"))

                    writer.releaseLock()

                    await device.close()

                } catch (error) {

                    console.log(error)

                }
            })
        })

    </script>
  </body>
</html>